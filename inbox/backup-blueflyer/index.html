<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>blueFlyer - Accessible Media Poster</title>

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="blueFlyer">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0085ff">
    <meta name="application-name" content="blueFlyer">

    <!-- Primary Meta Tags -->
    <meta name="title" content="blueFlyer - Accessible Media Poster">
    <meta name="description" content="Create accessible posts for Bluesky Social with automatic alt text generation for images and GIFs.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://actuallyusefulai.com/blueflyer">
    <meta property="og:title" content="blueFlyer - Accessible Media Poster">
    <meta property="og:description" content="Create accessible posts for Bluesky Social with automatic alt text generation for images and GIFs.">
    <meta property="og:image" content="https://actuallyusefulai.com/bsky/assets/spinner_transparent.gif">

    <!-- Twitter/Bluesky -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://actuallyusefulai.com/blueflyer">
    <meta name="twitter:title" content="blueFlyer - Accessible Media Poster">
    <meta name="twitter:description" content="Create accessible posts for Bluesky Social with automatic alt text generation for images and GIFs.">
    <meta name="twitter:image" content="https://actuallyusefulai.com/bsky/assets/spinner_transparent.gif">

    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/gif" href="https://actuallyusefulai.com/bsky/assets/spinner_transparent.gif">
    <link rel="apple-touch-icon" href="https://actuallyusefulai.com/bsky/assets/spinner_transparent.png">
    <link rel="apple-touch-icon" sizes="192x192" href="https://actuallyusefulai.com/bsky/assets/spinner_transparent.png">
    <link rel="apple-touch-icon" sizes="512x512" href="https://actuallyusefulai.com/bsky/assets/spinner_transparent.png">
    <link rel="mask-icon" href="https://actuallyusefulai.com/bsky/assets/spinner_transparent.png" color="#0085ff">

    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- External CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/index.css">
    
    <!-- PWA Installation Script -->
    <script src="js/pwa.js" defer></script>
</head>
<body class="not-logged-in">
    <!-- Screen reader announcements -->
    <div id="sr-announcements" class="sr-only" role="status" aria-live="polite"></div>
    <div id="sr-alerts" class="sr-only" role="alert"></div>

    <header class="main-header" role="banner">
        <div class="header-container">
            <div class="header-left">
                <img src="https://actuallyusefulai.com/bsky/assets/spinner_transparent.gif" 
                     alt="blueFlyer logo" 
                     class="header-logo"
                     role="img"
                     loading="eager"
                     decoding="async"
                     fetchpriority="high">
                <span class="header-title" role="heading" aria-level="1">blueFlyer</span>
            </div>
            <div class="header-actions" role="toolbar" aria-label="Main actions">
                <button id="installButton" 
                        class="install-btn hidden" 
                        aria-label="Install blueFlyer app"
                        tabindex="0">
                    <i class="fas fa-download" aria-hidden="true"></i>
                    <span>Install App</span>
                </button>
                <button id="logoutButton" 
                        class="logout-btn" 
                        onclick="logout()" 
                        aria-label="Log out of blueFlyer"
                        tabindex="0">
                    <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>
    </header>

    <main class="main-content" role="main">
        <!-- <div class="site-header container">
            <div class="header-text">
                <h1 class="site-title">blueFlyer</h1>
                <p class="site-subtitle">Accessible Media Poster</p>
            </div>
        </div> -->

        <div class="main-container">
            <!-- Login Form -->
            <form id="loginForm" 
                  class="form-group" 
                  role="form" 
                  aria-labelledby="login-heading">
                <h2 id="login-heading" class="sr-only">Login to blueFlyer</h2>
                <div class="form-group">
                    <label for="handle" id="handle-label">Handle</label>
                    <input type="text" 
                           id="handle" 
                           class="form-input" 
                           placeholder="you.bsky.social" 
                           required
                           autocomplete="username"
                           aria-required="true"
                           tabindex="0">
                </div>
                <div class="form-group">
                    <label for="password" id="password-label">App Password</label>
                    <input type="password" 
                           id="password" 
                           class="form-input" 
                           placeholder="Your App Password" 
                           autocomplete="current-password" 
                           required
                           aria-required="true"
                           tabindex="0">
                </div>
                <button type="button" 
                        class="btn btn-primary btn-login" 
                        onclick="login()"
                        aria-label="Log in to blueFlyer"
                        tabindex="0">Log in</button>
            </form>

            <!-- User Profile -->
            <div id="userProfile" 
                 class="hidden" 
                 role="region" 
                 aria-labelledby="profile-heading">
                <h2 id="profile-heading" class="sr-only">Your Profile</h2>
                <div class="cover-photo-container" role="img" aria-label="Profile cover photo">
                    <div class="cover-photo" id="coverPhoto"></div>
                    <div class="user-info-stats" role="list" aria-label="Profile statistics">
                        <div class="stat-item" role="listitem">
                            <span class="stat-label" id="posts-label">Posts</span>
                            <span id="postCount" class="stat-value" aria-labelledby="posts-label">-</span>
                        </div>
                        <div class="stat-item" role="listitem">
                            <span class="stat-label" id="following-label">Following</span>
                            <span id="followingCount" class="stat-value" aria-labelledby="following-label">-</span>
                        </div>
                        <div class="stat-item" role="listitem">
                            <span class="stat-label" id="followers-label">Followers</span>
                            <span id="followerCount" class="stat-value" aria-labelledby="followers-label">-</span>
                        </div>
                        <div class="stat-item" role="listitem">
                            <span class="stat-label" id="joined-label">Joined</span>
                            <span id="joinDate" class="stat-value" aria-labelledby="joined-label">-</span>
                        </div>
                    </div>
                    <button class="cover-toggle" 
                            aria-label="Toggle cover photo visibility" 
                            onclick="toggleCoverPhoto(this)"
                            tabindex="0">
                        <i class="fas fa-chevron-down" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="user-info">
                    <div class="user-info-header">
                        <div class="user-info-left">
                            <img id="avatar" 
                                 src="" 
                                 alt="" 
                                 class="avatar"
                                 loading="lazy"
                                 decoding="async">
                            <div class="user-details">
                                <p id="displayName" class="display-name"></p>
                                <p id="handleName" class="handle"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Create Post Form -->
                <form id="newPostForm" 
                      class="create-post" 
                      role="form" 
                      aria-labelledby="post-form-heading">
                    <h3 id="post-form-heading" class="sr-only">Create New Post</h3>
                    <div class="form-group">
                        <div id="postText" 
                             class="post-editor"
                             contenteditable="true"
                             role="textbox"
                             aria-multiline="true"
                             aria-label="Post content"
                             aria-describedby="charCount"
                             tabindex="0"
                             placeholder="Type your post! (You can also paste images here)"></div>
                        <div id="charCount" 
                             class="char-count" 
                             role="status" 
                             aria-live="polite">300</div>
                        <div id="gifSuggestions" 
                             class="gif-suggestions" 
                             role="listbox" 
                             aria-label="GIF suggestions"></div>
                    </div>
                    <div id="imageContainer" 
                         role="region" 
                         aria-label="Uploaded images"></div>
                    <div class="form-group">
                        <div class="file-upload-container" 
                             id="imageUploadArea"
                             role="region"
                             aria-label="Image upload area">
                            <div class="file-upload-dropzone"
                                 tabindex="0"
                                 role="button"
                                 aria-controls="imageUpload"
                                 aria-describedby="uploadInstructions">
                                <input type="file" 
                                       id="imageUpload" 
                                       class="file-upload-input" 
                                       accept="image/*" 
                                       multiple
                                       aria-label="Upload images">
                                <div class="upload-icon">
                                    <i class="fas fa-image" aria-hidden="true"></i>
                                </div>
                                <div class="upload-text">
                                    <p id="uploadInstructions" class="upload-instructions">
                                        Drag and drop images here<br>
                                        <span class="upload-instructions-sub">or click to select files</span>
                                    </p>
                                    <p class="upload-limit">(Maximum 4 images)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" 
                                class="btn btn-secondary btn-retry"
                                onclick="window.location.reload(true)"
                                aria-label="Start over"
                                tabindex="0">
                            <i class="fas fa-redo" aria-hidden="true"></i>
                            Start Over
                        </button>
                        <button type="submit" 
                                class="btn btn-primary btn-post"
                                aria-label="Submit post"
                                tabindex="0">
                            <i class="fas fa-paper-plane" aria-hidden="true"></i>
                            Post
                        </button>
                    </div>
                </form>
            </div>
            <p>
                This is an open source tool that uses a small, energy efficient language model to create alt text for images. 
                No data is stored and nothing is used for training. <a href="https://actuallyusefulai.com/about/ethics.html">Ethics</a>
            </p>
        </div>
        
    </main>

    <!-- Post Preview Modal -->
    <div id="postPreviewModal" 
         class="modal-overlay hidden" 
         role="dialog" 
         aria-modal="true" 
         aria-labelledby="modalTitle">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2 id="modalTitle" class="modal-title">Preview Post</h2>
                <button class="modal-close" aria-label="Close preview" onclick="closePreviewModal()">&times;</button>
            </div>
            <div class="preview-content">
                <div class="preview-user-info">
                    <img id="previewAvatar" class="preview-avatar" src="" alt="">
                    <div class="preview-user-details">
                        <span id="previewDisplayName" class="preview-display-name"></span>
                        <span id="previewHandle" class="preview-handle"></span>
                    </div>
                </div>
                <div id="previewText" class="preview-text"></div>
                <div id="previewImages" class="preview-images"></div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closePreviewModal()">Edit</button>
                <button class="btn btn-primary" onclick="confirmAndPost()">Post</button>
            </div>
            
        </div>
        
    </div>

    <footer class="site-footer" role="contentinfo">
        <div class="container">
            <!-- <p>This is an open source tool that uses a small, energy efficient language model to create alt text for images. 
                No data is stored and nothing is used for training. <a href="https://actuallyusefulai.com/about/ethics.html">Ethics</a>
            </p> -->

            <div class="badges-row">
                <a href="https://github.com/lukeslp/alt-text-local-ai" target="_blank" rel="noopener noreferrer" class="badge-link">
                    <img src="https://actuallyusefulai.com/alt/dev/assets/github.png" 
                         alt="View on GitHub" 
                         width="36" 
                         height="36"
                         loading="lazy"
                         decoding="async">
                </a>
                <a href="https://ollama.com/coolhand/altllama" target="_blank" rel="noopener noreferrer" class="badge-link">
                    <img src="https://actuallyusefulai.com/alt/dev/assets/ollama.png" 
                         alt="View on Ollama" 
                         width="36" 
                         height="36"
                         loading="lazy"
                         decoding="async">
                </a>
                <a href="https://patreon.com/lukeslp" target="_blank" rel="noopener noreferrer" class="badge-link">
                    <img src="https://actuallyusefulai.com/alt/dev/assets/patreon.png" 
                         alt="Support on Patreon" 
                         width="36" 
                         height="36"
                         loading="lazy"
                         decoding="async">
                </a>
                <a href="https://lukesteuber.substack.com" target="_blank" rel="noopener noreferrer" class="badge-link">
                    <img src="https://actuallyusefulai.com/alt/dev/assets/substack.png" 
                         alt="Read Luke's Substack" 
                         width="36" 
                         height="36"
                         loading="lazy"
                         decoding="async">
                </a>
                <a href="https://lukesteuber.com" target="_blank" rel="noopener noreferrer" class="badge-link">
                    <img src="https://actuallyusefulai.com/alt/dev/assets/frantic.png" 
                         alt="Visit Luke Steuber's website" 
                         width="36" 
                         height="36"
                         loading="lazy"
                         decoding="async">
                </a>
            </div>
        </div>
    </footer>

    <!-- External JavaScript -->
    <script type="module" src="js/main.js"></script>
    <script>
        // Update body class when logged in/out
        function updateLoginState(isLoggedIn) {
            document.body.classList.toggle('logged-in', isLoggedIn);
            document.body.classList.toggle('not-logged-in', !isLoggedIn);
            
            // No need to toggle hidden class on logout button
            // It's controlled by CSS based on body class
        }

        // Check login state on page load
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('loggedIn') === 'true';
            updateLoginState(isLoggedIn);
        });
    </script>
</body>
</html> 